-- 코드를 입력하세요
SELECT YEAR(SALES_DATE) YEAR, MONTH(SALES_DATE) MONTH, COUNT(DISTINCT(o.USER_ID)) PUCHASED_USERS, ROUND((COUNT(DISTINCT(o.USER_ID)) / (SELECT COUNT(USER_ID) FROM USER_INFO WHERE JOINED LIKE '2021%') ), 1) PUCHASED_RATIO  FROM ONLINE_SALE o JOIN USER_INFO i ON o.USER_ID = i.USER_ID WHERE JOINED LIKE '2021%' GROUP BY YEAR, MONTH ORDER BY YEAR, MONTH